% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tabu.operator.R
\name{tabu.operator}
\alias{tabu.operator}
\title{Tabu Search Operator for Pharmacometric Model Selection}
\usage{
tabu.operator(
  dat,
  param_table = NULL,
  tabu.control = tabuControl(),
  search.space = "ivbase",
  no.cores = rxode2::getRxThreads(),
  foldername = "test",
  filename = "test",
  penalty.control = penaltyControl(),
  precomputed_results_file = NULL,
  seed.no = 1234,
  ...
)
}
\arguments{
\item{dat}{Dataset (typically PK/PD data).}

\item{param_table}{Optional parameter table. If NULL, will be generated with auto_param_table().}

\item{tabu.control}{A list of tabu search control parameters:
\itemize{
\item \code{tabu.duration} — Integer. Number of iterations a move remains tabu.
\item \code{max.round} — Integer. Maximum number of search iterations.
\item \code{start.point} — Optional initial model code vector.
\item \code{aspiration} — Logical. If TRUE, allows aspiration criterion.
}}

\item{search.space}{Character. Search space type ("ivbase" or "oralbase").}

\item{no.cores}{Integer. Number of CPU cores to use.}

\item{foldername}{Character. Folder name for temporary outputs.}

\item{filename}{Character. Base filename for outputs.}

\item{penalty.control}{A list of penalty settings, typically from penaltyControl().}

\item{precomputed_results_file}{Optional cache file for model results.}

\item{seed.no}{Random seed.}

\item{...}{Additional arguments passed to mod.run().}
}
\value{
A list containing:
\item{best_model_name}{Selected best model (human-readable).}
\item{best_model_code}{Vector representation of best model.}
\item{history}{Tabu search history: starting points, local bests, tabu elements, neighbors.}
}
\description{
Performs Tabu Search to explore the pharmacometric model space and
identify the best-performing model. Supports both IV and Oral search spaces.
}
\details{
This function implements a customized Tabu Search framework for pharmacometric
model structure optimization. The key design choices are:
\itemize{
\item \strong{Solution representation}: Models are encoded as bit vectors
(e.g., number of compartments, inclusion of random effects, residual error structure).
\item \strong{Initial solution}: Default is a 2-compartment base model, or user-specified
via \code{tabu.control$start.point}.
\item \strong{Neighborhood definition}: All one-bit flips are considered (full neighborhood search),
with invalid models filtered (e.g., incompatible compartments).
\item \strong{Move definition}: A move is defined by which element is modified and its value change
(e.g., \code{no.cmpt: 2 -> 3}, \code{eta.vc: 0 -> 1}).
\item \strong{Tabu list}: Stores recent moves with remaining tabu tenure (\code{tabu.duration}).
\item \strong{Aspiration criterion}: If enabled, a tabu move is allowed if it produces
a model better than the historical best.
\item \strong{Objective function}: Model fit quality (e.g., AIC/OFV), computed by \code{mod.run()},
with penalties applied via \code{penalty.control}.
\item \strong{Termination}: Fixed number of iterations (\code{max.round}).
\item \strong{History tracking}: Stores starting points, local bests, tabu elements,
and neighbors at each iteration for visualization and traceability.
}
}
