% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sf.operator.R
\name{sf.operator}
\alias{sf.operator}
\title{Stepwise Model Building for Nonlinear Mixed-Effects Models}
\usage{
sf.operator(
  dat,
  search.space = "ivbase",
  param_table = NULL,
  penalty.control = penaltyControl(),
  no.cores = rxode2::getRxThreads(),
  foldername = "test",
  filename = "test",
  custom_base = NULL,
  dynamic_fitness = TRUE,
  precomputed_results_file = NULL,
  ...
)
}
\arguments{
\item{dat}{A dataset containing the pharmacokinetic/pharmacodynamic (PK/PD) data
to be modeled.}

\item{search.space}{Character string specifying the structural model search space.
Must be either \code{"ivbase"} (intravenous bolus) or \code{"oralbase"} (oral administration).}

\item{param_table}{Optional parameter table. If \code{NULL}, the function will generate
one automatically using \code{auto_param_table()}.}

\item{penalty.control}{An object created by \code{penaltyControl()} specifying
penalty terms to be used in model selection.}

\item{no.cores}{Integer specifying the number of threads for parallel execution.
Defaults to \code{rxode2::getRxThreads()}.}

\item{foldername}{Character string for naming the output folder.}

\item{filename}{Character string for naming output files.}

\item{custom_base}{Optional custom base model to use instead of the default generated one.}

\item{dynamic_fitness}{Logical; if \code{TRUE}, penalty terms change dynamically
during different steps of model building.}

\item{precomputed_results_file}{Optional path to a file containing precomputed
stepwise search results to avoid rerunning steps.}

\item{...}{Additional arguments passed to the underlying stepwise functions.}
}
\value{
An object of class \code{"sfOperatorResult"} containing:
\itemize{
\item \code{"Final Best Code"} – Best model code parameters.
\item \code{"Final Best Model Name"} – Name of the best model.
\item \code{"Stepwise Best Models"} – Summary of best models per step.
\item \code{"Stepwise History"} – Detailed results from each step.
\item \code{"Model Run History"} – All model runs performed.
}
}
\description{
The \code{sf.operator} function performs a stepwise model-building procedure
for nonlinear mixed-effects (NLME) models, including testing the number of
compartments, elimination type (e.g., Michaelis-Menten), inter-individual
variability (IIV), correlations, and residual error models.
}
\details{
This function is designed to work with the \code{nlmixr2} and \code{rxode2} workflow
and will create intermediate model runs and results in a temporary directory.

The procedure follows these steps:
\enumerate{
\item \strong{Step 1:} Select the optimal number of compartments.
\item \strong{Step 2:} Determine the elimination type (linear vs. Michaelis–Menten).
\item \strong{Step 3:} Test inclusion of inter-individual variability (IIV) terms.
\item \strong{Step 4:} Explore correlations between random effects (if any \verb{eta.*} terms exist).
\item \strong{Step 5:} Explore different residual error models.
}

If no \verb{eta.*} parameters remain after Step 3 (sum equals zero), Step 4
(correlation testing) will be skipped.

All intermediate results are stored in \code{Store.all} and the final best
model code is returned in a structured object of class \code{"sfOperatorResult"}.
}
\examples{
\dontrun{
result<-sf.operator(dat = pheno_sd)
print(result)
}

}
\seealso{
\code{\link{step_compartments}}, \code{\link{step_elimination}},
\code{\link{step_iiv}}, \code{\link{step_correlation}}, \code{\link{step_rv}}
}
